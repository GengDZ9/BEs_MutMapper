# README: Amino Acid Mutation Analysis and Visualization

## Overview
This project consists of two Python scripts that perform comprehensive analysis and visualization of amino acid mutations. The first script (`Analysis of BE mutation profiles.py`) generates mutation data based on codon mutations, and the second script (`Plot of BE mutation profiles.py`) visualizes these mutation data using heatmaps.

## Prerequisites
- **Python**: This project is developed and tested with Python 3.10.9. It is recommended to use this version or a compatible Python 3.x version to ensure smooth execution.
- **Libraries**: The following Python libraries are required:
  - `pandas`: Used for data manipulation and analysis.
  - `seaborn`: Used for creating statistical graphics, especially heatmaps.
  - `matplotlib`: Used for creating visualizations.
  - `itertools`: A built - in Python library used for generating combinations.

You can install the required libraries using `pip`:
```bash
pip install pandas seaborn matplotlib
```

## Scripts

### 1. `Analysis of BE mutation profiles.py`
#### Functionality
- **Codon Library Generation**: Generates a complete list of all possible codons (64 in total) using the four DNA bases (A, T, C, G).
- **Codon - Amino Acid Mapping**: Defines a codon table that maps each codon to its corresponding amino acid or 'Stop' signal.
- **Mutation Simulation**: Simulates all possible single, double, and triple base mutations for each codon in the codon library.
- **Data Output**: Stores the codon library, codon - amino acid mapping, and mutation results in separate Excel files (`codon_database.xlsx`, `amino_database.xlsx`, `mutation_results.xlsx`, `ori_mut.xlsx`).

#### Usage
Run the script in your Python environment:
```bash
python "Analysis of BE mutation profiles.py"
```
After running the script, you will see the following message indicating that the results have been saved:
```
results have been saved to codon_database.xlsx, amino_database.xlsx, mutation_results.xlsx,ori_mut.xlsx
```

### 2. `Plot of BE mutation profiles.py`
#### Functionality
- **Data Loading**: Reads the mutation data from the `ori_mut.xlsx` file generated by the previous script.
- **Mutation Counting**: Counts the number of mutations between different amino acids and stores the results in a DataFrame.
- **Heatmap Generation**: Creates two heatmaps to visualize the amino acid mutation profiles:
  - A heatmap showing the overall amino acid mutation counts.
  - A heatmap comparing synonymous and non - synonymous mutations at different mutation sites.
- **Plot Saving**: Saves the generated heatmaps as PDF files (`amino_acid_mutation_heatmap.pdf` and `Cluster_amino_acid_mutation_heatmap.pdf`).

#### Usage
Run the script in your Python environment:
```bash
python "Plot of BE mutation profiles.py"
```
After running the script, you will see the following messages indicating that the plots have been saved:
```
plot has been saved in amino_acid_mutation_heatmap.pdf
plot has been saved in Cluster_amino_acid_mutation_heatmap.pdfã€‚
```

## Notes
- Make sure the `Analysis of BE mutation profiles.py` script is run before the `Plot of BE mutation profiles.py` script, as the latter depends on the `ori_mut.xlsx` file generated by the former.
- The code assumes that the Excel files are in the same directory as the Python scripts. If the files are located elsewhere, you need to modify the file paths in the code accordingly.